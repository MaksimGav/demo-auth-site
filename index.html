<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>AutoWash Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#f6f8fc;
  --card:#ffffff;
  --primary:#2563eb;
  --success:#22c55e;
  --danger:#ef4444;
  --text:#0f172a;
  --muted:#64748b;
  --radius:18px;
}

*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif}
body{margin:0;background:var(--bg);color:var(--text)}

header{
  background:#0f172a;color:white;
  padding:16px 20px;
  display:flex;justify-content:space-between;align-items:center
}

.container{max-width:420px;margin:auto;padding:20px}

.card{
  background:var(--card);
  padding:20px;
  border-radius:var(--radius);
  box-shadow:0 16px 32px rgba(0,0,0,.08);
  margin-bottom:16px;
  animation:fade .3s ease;
}

input{
  width:100%;padding:14px;
  border-radius:14px;
  border:1px solid #e5e7eb;
  margin-bottom:10px;
}

button{
  width:100%;padding:14px;
  border:none;border-radius:14px;
  background:var(--primary);
  color:white;font-size:15px;
  margin-bottom:8px;
}

button.success{background:var(--success)}
button.danger{background:var(--danger)}
button.gray{background:#e5e7eb;color:#0f172a}

.hidden{display:none}

@keyframes fade{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:translateY(0)}
}
</style>
</head>

<body>

<header class="hidden" id="topbar">
  <b>üöó AutoWash</b>
  <button class="gray" onclick="logout()">–í–∏–π—Ç–∏</button>
</header>

<!-- AUTH -->
<div class="container" id="auth">
  <div class="card">
    <h2>–í—Ö—ñ–¥</h2>
    <input id="phone" placeholder="+380XXXXXXXXX">
    <button onclick="sendSMS()">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏</button>
    <p style="font-size:12px;color:var(--muted)">DEMO-–≤–µ—Ä—Å—ñ—è</p>
  </div>
</div>

<!-- SMS -->
<div class="container hidden" id="sms">
  <div class="card">
    <h3>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è</h3>
    <p id="demoSMS"></p>
    <input id="code" placeholder="SMS-–∫–æ–¥">
    <button class="success" onclick="verifySMS()">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
  </div>
</div>

<!-- USER -->
<div class="container hidden" id="user">
  <div class="card">
    <h2>–ü—ñ–¥–ø–∏—Å–∫–∏</h2>

    <div class="card">
      <b>üü¢ –¢–∏–∂–Ω–µ–≤–∞</b>
      <p>199 –≥—Ä–Ω</p>
      <button onclick="buy('week')">–ö—É–ø–∏—Ç–∏</button>
    </div>

    <div class="card">
      <b>üîµ –ú—ñ—Å—è—á–Ω–∞</b>
      <p>599 –≥—Ä–Ω</p>
      <button onclick="buy('month')">–ö—É–ø–∏—Ç–∏</button>
    </div>
  </div>

  <div class="card hidden" id="qrBlock">
    <h3>–í–∞—à QR-–∫–æ–¥</h3>
    <img id="qrImg">
    <p style="font-size:12px;color:var(--muted)">–ü–æ–∫–∞–∂—ñ—Ç—å QR –Ω–∞ –∞–≤—Ç–æ–º–∏–π—Ü—ñ</p>
  </div>
</div>

<!-- ADMIN -->
<div class="container hidden" id="admin">
  <div class="card">
    <h2>üîê –ê–¥–º—ñ–Ω –ø–∞–Ω–µ–ª—å</h2>
    <p>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: <b id="adminUsers"></b></p>
    <p>–ü—ñ–¥–ø–∏—Å–æ–∫: <b id="adminSubs"></b></p>
  </div>

  <div class="card">
    <h3>–ö–µ—Ä—É–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–∏—Å–∫–æ—é</h3>
    <input id="qrInput" placeholder="QR-–∫–æ–¥">
    <button onclick="findSub()">–ó–Ω–∞–π—Ç–∏</button>

    <div id="subControl" class="hidden">
      <p id="subInfo"></p>
      <button class="gray" onclick="pauseSub()">‚è∏ –ü–∞—É–∑–∞ 1 –¥–µ–Ω—å</button>
      <button class="danger" onclick="disableSub()">‚ùå –î–µ–∞–∫—Ç–∏–≤—É–≤–∞—Ç–∏</button>
      <button class="success" onclick="activateSub()">‚ñ∂Ô∏è –ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏</button>
    </div>
  </div>
</div>

<script>
let smsCode="", currentPhone="", currentSubIndex=null;

function hideAll(){
  ['auth','sms','user','admin'].forEach(id=>document.getElementById(id).classList.add('hidden'));
}

function sendSMS(){
  const phone=document.getElementById('phone').value.trim();

  if(phone==="1234321"){ openAdmin(); return; }

  if(phone.length<6){ alert("–ù–µ–∫–æ—Ä–µ–∫—Ç–Ω–∏–π –Ω–æ–º–µ—Ä"); return; }

  currentPhone=phone;
  smsCode=Math.floor(1000+Math.random()*9000).toString();
  demoSMS.innerText="üì© DEMO SMS: "+smsCode;

  hideAll(); sms.classList.remove('hidden');
}

function verifySMS(){
  if(code.value!==smsCode){ alert("–ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥"); return; }

  const users=JSON.parse(localStorage.getItem("users")||"[]");
  if(!users.includes(currentPhone)){
    users.push(currentPhone);
    localStorage.setItem("users",JSON.stringify(users));
  }

  localStorage.setItem("session",currentPhone);
  showUser();
}

function showUser(){
  hideAll();
  topbar.classList.remove('hidden');
  user.classList.remove('hidden');
}

function buy(type){
  alert("–û–ø–ª–∞—Ç–∞ —É—Å–ø—ñ—à–Ω–∞ (DEMO)");

  const phone=localStorage.getItem("session");
  const subs=JSON.parse(localStorage.getItem("subs")||"[]");

  const qr=`AUTOWASH|${phone}|${type}`;
  subs.push({phone,type,qr,status:"active",pauseUntil:null});
  localStorage.setItem("subs",JSON.stringify(subs));

  qrImg.src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data="+encodeURIComponent(qr);
  qrBlock.classList.remove("hidden");
}

function openAdmin(){
  hideAll();
  topbar.classList.remove('hidden');
  admin.classList.remove('hidden');

  adminUsers.innerText=(JSON.parse(localStorage.getItem("users")||"[]")).length;
  adminSubs.innerText=(JSON.parse(localStorage.getItem("subs")||"[]")).length;
}

function findSub(){
  const qr=qrInput.value.trim();
  const subs=JSON.parse(localStorage.getItem("subs")||"[]");

  const i=subs.findIndex(s=>s.qr===qr);
  if(i===-1){ alert("–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ"); return; }

  currentSubIndex=i;
  const s=subs[i];
  subInfo.innerHTML=`–¢–µ–ª–µ—Ñ–æ–Ω: <b>${s.phone}</b><br>–¢–∏–ø: <b>${s.type}</b><br>–°—Ç–∞—Ç—É—Å: <b>${s.status}</b>`;
  subControl.classList.remove("hidden");
}

function updateSub(status,days=null){
  const subs=JSON.parse(localStorage.getItem("subs")||"[]");
  subs[currentSubIndex].status=status;
  subs[currentSubIndex].pauseUntil=days?Date.now()+days*86400000:null;
  localStorage.setItem("subs",JSON.stringify(subs));
  alert("–û–Ω–æ–≤–ª–µ–Ω–æ");
}

function pauseSub(){updateSub("paused",1)}
function disableSub(){updateSub("disabled")}
function activateSub(){updateSub("active")}

function logout(){
  localStorage.removeItem("session");
  location.reload();
}

const session=localStorage.getItem("session");
if(session) showUser();
</script>

</body>
</html>
